<!DOCTYPE html>
<html lang="en">
  <head>
    <title></title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- <link href="css/style.css" rel="stylesheet"> -->
  </head>
  <script>
    const data = [
      ["name_city", "name_coun", "name_town", "value"],
      ["金华市", "磐安县", "", 2968],
      ["台州市", "天台县", "", 5711],
      ["台州市", "", "", 6281],
      ["台州市", "天台县", "石梁镇", 490],
      ["台州市", "仙居县", "", 6570],
      ["台州市", "仙居县", "埠头镇", 986],
      ["台州市", "临海市", "", 1735],
      ["台州市", "临海市", "大洋街道", 6212],
      ["台州市", "临海市", "大田街道", 5425],
      ["台州市", "临海市", "江南街道", 2858],
      ["台州市", "黄岩区", "", 1000],
      ["台州市", "黄岩区", "澄江街道", 1891],
      ["台州市", "黄岩区", "南城街道", 5430],
      ["嘉兴市", "桐乡市", "", 2733],
      ["嘉兴市", "海盐县", "", 5740],
      ["嘉兴市", "", "", 6904],
      ["嘉兴市", "海宁市", "周王庙镇", 5602],
      ["嘉兴市", "海宁市", "", 6227],
      ["丽水市", "云和县", "", 974],
      ["丽水市", "庆元县", "", 102],
      ["嘉兴市", "南湖区", "", 2367],
      ["嘉兴市", "嘉善县", "", 316],
      ["衢州市", "", "", 641],
      ["衢州市", "衢江区", "", 6392],
      ["衢州市", "衢江区", "云溪乡", 526],
      ["衢州市", "龙游县", "", 6079],
      ["金华市", "义乌市", "", 1474],
      ["金华市", "浦江县", "", 1103],
      ["金华市", "", "", 6165],
      ["金华市", "浦江县", "黄宅镇", 5471],
      ["宁波市", "北仑区", "", 11012],
      ["台州市", "椒江区", "下陈街道", 6478],
      ["台州市", "椒江区", "", 214],
      ["台州市", "路桥区", "", 5965],
      ["台州市", "温岭市", "", 1305],
      ["台州市", "温岭市", "城西街道", 6088],
      ["台州市", "玉环市", "", 1732],
      ["台州市", "三门县", "海游街道", 5616],
      ["台州市", "三门县", "", 6417],
      ["宁波市", "宁海县", "", 18077],
      ["宁波市", "", "", 18668],
      ["宁波市", "奉化区", "岳林街道", 19035],
      ["宁波市", "奉化区", "", 16356],
      ["宁波市", "海曙区", "", 11740],
      ["宁波市", "海曙区", "望春街道", 16661],
      ["宁波市", "海曙区", "高桥镇", 10013],
      ["宁波市", "海曙区", "横街镇", 18011],
      ["宁波市", "江北区", "", 16110],
      ["宁波市", "余姚市", "", 12773],
      ["宁波市", "慈溪市", "", 18852],
      ["宁波市", "慈溪市", "古塘街道", 17563],
      ["宁波市", "慈溪市", "白沙路街道", 17640],
      ["绍兴市", "嵊州市", "", 82],
      ["绍兴市", "嵊州市", "鹿山街道", 5312],
      ["绍兴市", "", "", 6017],
      ["绍兴市", "嵊州市", "三界镇", 1433],
      ["绍兴市", "嵊州市", "浦口街道", 2580],
      ["绍兴市", "新昌县", "城南乡", 625],
      ["绍兴市", "新昌县", "澄潭街道", 1059],
      ["绍兴市", "新昌县", "", 333],
      ["绍兴市", "越城区", "塔山街道", 5335],
      ["绍兴市", "越城区", "", 790],
      ["绍兴市", "越城区", "北海街道", 1699],
      ["绍兴市", "越城区", "富盛镇", 2495],
      ["绍兴市", "嵊州市", "金庭镇", 2890],
      ["金华市", "东阳市", "", 2821],
      ["金华市", "东阳市", "南市街道", 5918],
      ["金华市", "金东区", "", 5605],
      ["金华市", "武义县", "", 6900],
      ["金华市", "武义县", "白姆乡", 5964],
      ["金华市", "婺城区", "", 6140],
      ["金华市", "婺城区", "箬阳乡", 6008],
      ["金华市", "永康市", "", 5090],
      ["绍兴市", "嵊州市", "长乐镇", 5308],
      ["丽水市", "松阳县", "", 2301],
      ["丽水市", "遂昌县", "", 5559],
      ["丽水市", "", "", 1570],
      ["丽水市", "遂昌县", "濂竹乡", 5819],
      ["丽水市", "龙泉市", "", 2279],
      ["丽水市", "龙泉市", "上垟镇", 1076],
      ["嘉兴市", "平湖市", "", 5895],
      ["嘉兴市", "平湖市", "钟埭街道", 6692],
      ["嘉兴市", "秀洲区", "", 1656],
      ["嘉兴市", "秀洲区", "嘉北街道", 6456],
      ["嘉兴市", "秀洲区", "新城街道", 5214],
      ["嘉兴市", "海盐县", "望海街道", 5390],
      ["嘉兴市", "嘉善县", "大云镇", 6794],
      ["嘉兴市", "南湖区", "城南街道", 2936],
      ["嘉兴市", "桐乡市", "梧桐街道", 6945],
      ["丽水市", "缙云县", "", 6907],
      ["丽水市", "缙云县", "仙都街道", 50],
      ["丽水市", "缙云县", "前路乡", 6237],
      ["丽水市", "缙云县", "大源镇", 5843],
      ["台州市", "仙居县", "溪港乡", 5812],
      ["杭州市", "富阳区", "胥口镇", 22363],
      ["杭州市", "富阳区", "", 36102],
      ["杭州市", "", "", 29416],
      ["杭州市", "上城区", "", 20877],
      ["杭州市", "钱塘区", "", 23829],
      ["杭州市", "余杭区", "", 36592],
      ["杭州市", "临平区", "", 35135],
      ["杭州市", "上城区", "望江街道", 34893],
      ["杭州市", "拱墅区", "", 25803],
      ["杭州市", "拱墅区", "东新街道", 31321],
      ["杭州市", "淳安县", "", 23940],
      ["杭州市", "滨江区", "", 33639],
      ["衢州市", "衢江区", "灰坪乡", 5413],
      ["衢州市", "衢江区", "太真乡", 5612],
      ["丽水市", "景宁畲族自治县", "", 1432],
      ["丽水市", "景宁畲族自治县", "梧桐乡", 1778],
      ["丽水市", "景宁畲族自治县", "景南乡", 5354],
      ["丽水市", "莲都区", "", 39],
      ["丽水市", "莲都区", "老竹畲族镇", 6370],
      ["丽水市", "青田县", "", 5990],
      ["丽水市", "青田县", "祯埠镇", 18],
      ["丽水市", "青田县", "东源镇", 1259],
      ["丽水市", "青田县", "山口镇", 1112],
      ["丽水市", "青田县", "瓯南街道", 1090],
      ["丽水市", "缙云县", "大洋镇", 89],
      ["宁波市", "鄞州区", "", 13764],
      ["宁波市", "鄞州区", "中河街道", 14113],
      ["宁波市", "鄞州区", "百丈街道", 18526],
      ["宁波市", "鄞州区", "东吴镇", 10821],
      ["宁波市", "镇海区", "", 11721],
      ["杭州市", "临安区", "河桥镇", 32664],
      ["杭州市", "临安区", "锦北街道", 37618],
      ["杭州市", "建德市", "", 31245],
      ["杭州市", "建德市", "钦堂乡", 23625],
      ["杭州市", "桐庐县", "", 35487],
      ["杭州市", "临安区", "", 29036],
      ["金华市", "兰溪市", "", 6410],
      ["金华市", "兰溪市", "兰江街道", 5864],
      ["杭州市", "建德市", "更楼街道", 24542],
      ["绍兴市", "诸暨市", "", 2866],
      ["绍兴市", "诸暨市", "璜山镇", 444],
      ["绍兴市", "柯桥区", "", 222],
      ["绍兴市", "上虞区", "", 6168],
      ["绍兴市", "上虞区", "道墟街道", 6496],
      ["绍兴市", "上虞区", "丰惠镇", 319],
      ["杭州市", "临安区", "潜川镇", 25558],
      ["湖州市", "安吉县", "", 128],
      ["湖州市", "吴兴区", "", 1329],
      ["湖州市", "", "", 6905],
      ["湖州市", "吴兴区", "爱山街道", 41],
      ["湖州市", "吴兴区", "仁皇山街道", 637],
      ["湖州市", "吴兴区", "龙溪街道", 101],
      ["湖州市", "德清县", "", 2976],
      ["湖州市", "南浔区", "", 6103],
      ["湖州市", "南浔区", "旧馆镇", 495],
      ["湖州市", "长兴县", "", 2080],
      ["湖州市", "长兴县", "水口乡", 2648],
      ["湖州市", "德清县", "莫干山镇", 6820],
      ["湖州市", "德清县", "下渚湖街道", 6832],
      ["湖州市", "德清县", "雷甸镇", 6625],
      ["金华市", "兰溪市", "游埠镇", 520],
      ["绍兴市", "诸暨市", "安华镇", 1902],
      ["温州市", "平阳县", "", 6739],
      ["温州市", "平阳县", "腾蛟镇", 1215],
      ["温州市", "瓯海区", "", 6648],
      ["温州市", "瓯海区", "景山街道", 6884],
      ["温州市", "瓯海区", "梧田街道", 6910],
      ["衢州市", "常山县", "", 1917],
      ["衢州市", "开化县", "", 5587],
      ["衢州市", "开化县", "杨林镇", 6039],
      ["衢州市", "开化县", "何田乡", 2421],
      ["衢州市", "开化县", "中村乡", 724],
      ["衢州市", "江山市", "石门镇", 828],
      ["衢州市", "江山市", "", 5347],
      ["衢州市", "江山市", "双塔街道", 5956],
      ["衢州市", "柯城区", "", 2421],
      ["衢州市", "柯城区", "七里乡", 1290],
      ["杭州市", "拱墅区", "康桥街道", 31119],
      ["杭州市", "西湖区", "", 30402],
      ["杭州市", "萧山区", "", 20394],
      ["杭州市", "钱塘区", "新湾街道", 39670],
      ["杭州市", "西湖区", "转塘街道", 25442],
      ["杭州市", "萧山区", "新街街道", 20261],
      ["杭州市", "西湖区", "双浦镇", 34394],
      ["温州市", "乐清市", "", 1892],
      ["温州市", "", "", 2601],
      ["温州市", "乐清市", "石帆街道", 6296],
      ["温州市", "瑞安市", "", 738],
      ["温州市", "瑞安市", "高楼镇", 680],
      ["温州市", "泰顺县", "竹里畲族乡", 2326],
      ["温州市", "泰顺县", "三魁镇", 5664],
      ["温州市", "泰顺县", "", 1627],
      ["温州市", "泰顺县", "百丈镇", 2399],
      ["温州市", "永嘉县", "", 1035],
      ["温州市", "永嘉县", "岩头镇", 5902],
      ["温州市", "永嘉县", "桥头镇", 5819],
      ["温州市", "文成县", "周山畲族乡", 6312],
      ["温州市", "文成县", "", 2225],
      ["丽水市", "青田县", "岭根乡", 221],
      ["温州市", "苍南县", "", 335],
      ["温州市", "鹿城区", "", 2975],
      ["温州市", "龙湾区", "", 2339],
      ["舟山市", "定海区", "", 2618],
      ["杭州市", "钱塘区", "白杨街道", 35944],
      ["杭州市", "建德市", "三都镇", 29747],
      ["丽水市", "庆元县", "竹口镇", 5173],
      ["丽水市", "庆元县", "江根乡", 2849],
      ["绍兴市", "柯桥区", "安昌街道", 6801],
      ["温州市", "乐清市", "仙溪镇", 5704],
      ["温州市", "瑞安市", "塘下镇", 1885],
      ["温州市", "龙湾区", "星海街道", 5875],
      ["温州市", "龙湾区", "蒲州街道", 6369],
      ["宁波市", "象山县", "", 13173],
      ["宁波市", "象山县", "墙头镇", 16333],
      ["台州市", "三门县", "健跳镇", 5570],
      ["宁波市", "北仑区", "大榭街道", 19391],
      ["台州市", "临海市", "杜桥镇", 5795],
      ["台州市", "三门县", "花桥镇", 6229],
      ["温州市", "龙湾区", "海城街道", 6226],
      ["宁波市", "慈溪市", "新浦镇", 14479],
      ["绍兴市", "诸暨市", "暨南街道", 6436],
      ["杭州市", "萧山区", "楼塔镇", 20219],
      ["杭州市", "淳安县", "威坪镇", 23172],
      ["温州市", "乐清市", "南塘镇", 781],
      ["杭州市", "萧山区", "宁围街道", 20365],
      ["杭州市", "余杭区", "良渚街道", 27006],
      ["温州市", "龙港市", "", 6678],
      ["舟山市", "", "", 6642],
      ["舟山市", "普陀区", "", 335],
      ["舟山市", "岱山县", "", 1650],
      ["温州市", "龙湾区", "瑶溪街道", 1271],
      ["温州市", "洞头区", "", 158],
      ["温州市", "乐清市", "翁垟街道", 2950],
      ["宁波市", "镇海区", "蛟川街道", 15708],
      ["舟山市", "岱山县", "岱西镇", 1978],
      ["舟山市", "嵊泗县", "", 527],
      ["台州市", "玉环市", "鸡山乡", 2221],
      ["舟山市", "嵊泗县", "嵊山镇", 1856],
    ];
    const header = data[0];
    const body = data.slice(1).map((row) => row.slice(0, row.length));
    let res = [];

    body.forEach((row, rowNum) => {
      let firstLevelNode = res.find((node) => node.name === row[0]);
      if (!firstLevelNode) {
        firstLevelNode = {
          name: row[0],
          children: [],
          value: 0,
        };
        res.push(firstLevelNode);
      }
      let pointer = firstLevelNode;
      row.slice(1).forEach((col, colNum) => {
        if (!col) return;
        if (colNum === header.length - 2) {
          pointer.value = row[header.length - 1];
          return;
        }
        if (!pointer.children) pointer.children = [];
        let childNode = pointer.children.find((node) => node.name === col);
        if (!childNode) {
          childNode = {
            name: col,
            children: [],
            // value: row[header.length - 1],
          };
          pointer.children.push(childNode);
        }
        pointer = childNode;
        if (!row[colNum + 2]) {
          pointer.value = row[header.length - 1];
        }
      });
    });

    res.forEach((e) => {
      let count = 0;
      function qiuhe(node) {
        if (node.children && node.children.length !== 0) {
          let sum = 0;
          node.children.forEach((item) => {
            sum += qiuhe(item);
            // console.log(sum)
          });
          node.value = sum;
        } else {
          count += node.value;
          return node.value;
        }
        e.value = count;
      }
      qiuhe(e);
      // let sum = 0;
      // function isLeaf(ele) {
      //   if (ele.children && ele.children.length !== 0) {
      //     // isLeaf(ele.children);
      //     ele.children.forEach((i) => {
      //       isLeaf(i);
      //     });
      //   } else {
      //     ele.value
      //     sum += ele.value;
      //   }
      // }
      // isLeaf(e);
      // e.value = sum;
    });

    // function count(tree) {
    //   let sum = 0;
    //   isLeaf(tree);
    //   function isLeaf(tree) {
    //     console.log(tree)
    //     if (tree.children) {
    //       console.log(tree);
    //       tree.children.forEach((e) => {
    //         count(e);
    //       });
    //     } else {
    //       console.log(tree);
    //     }
    //     if (!tree.children) {
    //       console.log(tree.value);
    //     } else {
    //       isLeaf(tree.children);
    //     }
    //   }
    // }
    // count(res);
    console.log(res);
  </script>
  <body></body>
</html>
